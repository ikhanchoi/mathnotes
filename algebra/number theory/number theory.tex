\documentclass{../../large}
\usepackage{../../ikhanchoi}


\begin{document}
\title{Number Theory}
\author{Ikhan Choi}
\maketitle
\tableofcontents

\part{Elementary number theory}

\chapter{Quadratic reciprocity}

\section{Congruence}

\begin{prb}[Computation with binomial theorem]
	
\end{prb}


\begin{prb}[Fermat's little theorem]
and Euler theorem
\[a^p\equiv a\pmod p.\qquad a^{\f(n)}\equiv1\pmod n.\]
\end{prb}

Wilson's theorem $(n-1)!\equiv-1\pmod n$.


\section{Quadratic residue}

\begin{prb}
\[x^2\equiv0,1\pmod{3,4}\]
\[x^2\equiv0,1,4\pmod{5,8}\]
\[x^2\equiv0,1,3,4\pmod{6}\]
\[x^2\equiv0,1,2,4\pmod{7}\]
\[x^2\equiv0,1,4,7\pmod{9}\]
\[x^2\equiv0,1,4,9\pmod{12}\]
\end{prb}

\begin{prb}[Supplental laws]
Let $p$ be an odd prime.
\begin{parts}
\item $\left(\frac{-1}p\right)=(-1)^{\frac{p-1}2}$.
\item $\left(\frac2p\right)=1$ if and only if $p\equiv\pm1\pmod8$.
\item $\left(\frac3p\right)=1$ if and only if $p\equiv\pm1\pmod{12}$.
\item $\left(\frac5p\right)=1$ if and only if $p\equiv\pm1\pmod5.$
\end{parts}
\end{prb}

\begin{prb}[Euler's criterion]
\[\left(\frac ap\right)\equiv a^{\frac{p-1}2}\pmod p.\]
\end{prb}

\begin{prb}[Quadratic Gauss sum]
Let $p$ be an odd prime.
The \emph{quadratic Gauss sum} is
\[\tau_p:=\sum_{n=0}^{p-1}\zeta_p^{n^2},\]
where $\zeta_p:=e^{2\pi i/p}$ is a primitive $p$th root of unity in any field.
Define $p^*:=(-1)^{\frac{p-1}2}p$.
\begin{parts}
\item We have
\[\tau_p=\sum_{a=0}^{p-1}\left(\frac ap\right)\zeta_p^a.\]
\item We have
\[\tau_p^2=p^*.\]
\end{parts}
\end{prb}

\begin{prb}[Quadratic reciprocity]
Let $\ell$ be an odd prime and consider field extensions $\Q(\zeta_\ell)/\Q(\tau_\ell)$.
Here $L:=\Q(\tau_\ell)$ and $K:=\Q$.

Let $p$ be an odd prime with $p\ne\ell$.
Then, $L_p$ is an unramified extension of $K_p$.(maybe)
We are interested in a criterion for $p$ to split in $\Q(\tau_\ell)$.
Note that $p$ splits in $\Q(\tau_\ell)$ if and only if the Frobenius homomorphism in $\Gal(l_p/k_p)$ is the identity.

Note that the residue field $k_p=\F_p$ of the local field $K_p=\Q_p$ has $q=p$ elements.
Note that $\sigma_q:x\mapsto x^q$ gives rise to a field automorphism of $\Gal(\Q(\tau_\ell)/\Q)$, called the \emph{Frobenius automorphism}.
\begin{parts}
\item From the Gauss sum, we have
\[\sigma_p(\tau_\ell)=\left(\frac p\ell\right)\tau_\ell.\]
\item From the Euler criterion, we have
\[\sigma_p(\tau_\ell)=\left(\frac{\ell^*}p\right)\tau_\ell.\]
\end{parts}
\end{prb}
\begin{pf}
(a)
We have
\[\sigma_p(\tau_\ell)
=\sigma_p\left(\sum_{a=0}^{\ell-1}\left(\frac a\ell\right)\zeta_\ell^a\right)
=\sum_{a=0}^{\ell-1}\left(\frac a\ell\right)\zeta_\ell^{ap}
=\sum_{a=0}^{\ell-1}\left(\frac p\ell\right)\left(\frac{ap}\ell\right)\zeta_\ell^{ap}
=\left(\frac p\ell\right)\tau_\ell\]

(b)
By the Euler criterion, we have
\[\sigma_p(\tau_\ell)=\tau_\ell^p=(\ell^*)^{\frac{p-1}2}\tau_\ell=\left(\frac{\ell^*}p\right)\tau_\ell.\]

\end{pf}





\section{Binary quadratic forms}
{Reduced forms}
{Indefinite forms}

{Ideal class group}

\begin{prb}[Heegner number]
There are only nine numbers
\[-1,-2,-3,-7,-11,-19,-43,-67,-163.\]
\end{prb}



\section*{Exercises}
\begin{prb}[Dirichlet theorems by quadratic reciprocity]
\begin{parts}
\item For $f(x)\in\Z[x]$, there exist infinitely many primes $p$ such that $p\mid f(x)$ for some $x$.
\item There are infinitely many primes $p$ such that $p\equiv1\pmod4$.
\end{parts}
\end{prb}

\begin{prb}
$y^2=f(x)$

Higher order sides: At least a prime divisor of $f$ with a congruence (e.g. $4k+3$)
Quantratic sides: Every prime divisor of $f$ must satisfy a congruence (e.g. $4k+1$)
\end{prb}


\begin{prb}[Primes of the form $x^2-ny^2$]
(It is a very important problem in listing primes in $\cO_K$)
(Want to describe the surjective homomorphism $\Spec\Z[i]\to\Spec\Z$)
\end{prb}







\chapter{Multiplicative number theory}
\section{Arithmetic functions}
\section{Dirichlet theorem}
\section{Prime number theorem}



\chapter{Algebraic numbers}




\section*{Exercises}
\begin{prb}[Mordell equation with no solutions]
$k=7,-5,-6,45,6,46,-24,-3,-9,-12$.
\begin{parts}
\item $y^2=x^3+7$ has no integral solutions.
\end{parts}
\end{prb}
\begin{pf}
(a)
Taking mod 8, $x$ is odd and $y$ is even.
The factorization
\[y^2+1=(x+2)((x-1)^2+3),\]
implies the existence of a prime factor $p=4k+3$ of $y^2+1$, which is impossible, so the equation has no solutions.
\end{pf}

\begin{prb}[Mordell equation with solutions]
\begin{parts}
\item $y^2=x^3-2$ has only two solutions.
\end{parts}
\end{prb}
\begin{pf}
(a)
Taking mod 8, $x$ and $y$ are odd.
Consider a ring of algebraic integers $\Z[\sqrt{-2}]$.
Write $N=N_{\Q(\sqrt{-2})/\Q}$.
The equation is factorized into
\[x^3=(y-\sqrt{-2})(y+\sqrt{-2}).\]
Let $\delta$ be a common divisor of $y\pm\sqrt{-2}$.
Then $\delta\mid 2\sqrt{-2}$ implies $N(\delta)\mid N(2\sqrt{-2})=8$, and since $N(\delta)\mid N(y-\sqrt{-2})=x^3$ is odd, we have $N(\delta)=1$ and $\delta$ is a unit.
It means that $y\pm\sqrt{-2}$ are relatively prime.
Since the units in $\Z[\sqrt{-2}]$ are $\pm1$, which are all cubes, $y\pm\sqrt{-2}$ are cubes in $\Z[\sqrt{-2}]$.

Let
\[y+\sqrt{-2}=(a+b\sqrt{-2})^3=a(a^2-6b^2)+b(3a^2-2b^2)\sqrt{-2},\]
so that $1=b(3a^2-2b^2)$.
We can conclude $b=\pm1$.
The possible solutions are $(x,y)=(3,\pm5)$, which are in fact solutions.
\end{pf}



\section*{Problems}

\begin{enumerate}
\item Show that if $(x^2+y^2+z^2)/(xy+yz+zx)$ is a well-defined integer for integers $x,y,z$, then it is not divided by three.
\item There is no non-trivial integral solution of $x^4-y^4=z^2$.
\end{enumerate}











\part{Diophantine equations}
\chapter{Pell equation}
\section{Continued fraction}
Diophantine approximation, Thue theorem

\section{}
Ellipse is reduced by finitely many computations.


Especially for hyperbola, here is a strategy to use infinite descent.
\begin{parts}
\item Let midpoint to be origin.
\item Find the subgroup of $\SL_2(\Z)$ preserving the image of hyperbola(which would be isomorphic to $\Z$).
\item Find an impossible region.
\item Assume a solution and reduce it to the either impossible region or the ground solution.
\end{parts}

\begin{ex}[Pell's equation]
Consider\[x^2-2y^2=1.\]
A generator of hyperbola generating group is $g=\begin{pmatrix}3&4\\2&3\end{pmatrix}$.
It has a ground solution $(1,0)$ and impossible region $1<x<3$.
If $(a,b)$ is a solution with $a>0$, then we can find $n$ such that $g^n(a,b)$ is in the region $[1,3)$.
The possible case is $g^n(a,b)=(1,0)$.
\end{ex}
\begin{ex}[IMO 1988, the last problem]
Consider a family of equations\[x^2+y^2-kxy-k=0.\]
By the vieta jumping, a generator is $g:(a,b)\mapsto(b,kb-a)$.
It has an impossible region $xy<0$ : $x^2+y^2-kxy-k\ge x^2+y^2>0$.
If $(a,b)$ is a solution with $a>b$, then we can find $n$ such that $g^n(a,b)$ is in the region $xy\le0$.
Only possible case is $g^n(a,b)=(\sqrt k,0)$ or $g^n(a,b)=(0,-\sqrt k)$.
In ohter words, the equation has a solution iff $k$ is a perfect square.

In general, the transformation $(x,y)\mapsto(y,ky-x)$ preserving the image of hyperbola is not easy to find.
A strategy to find it in this problem is called the \emph{Vieta jumping} or \emph{root flipping}.
It gets the name by the following reason:
If $(a,b)$ is a solution with $a>b$, then a quadratic equation \[x^2-kbx+b^2-k=0\] has a root $a$, and the other root is $kb-a$ so that $(b,kb-a)$ is also a solution.
The last problem is from the International Mathematical Olympiad 1988, and the Vieta jumping technique was firstly used to solve it.
\end{ex}








\chapter{Local-global principle}

\section{$p$-adic numbers}

Let $p\in\Z$ be a prime.
The ring of the $p$-adic integers $\Z_p$ is defined by the inverse limit:
\[
\Z_p:=\lim\limits_{\substack{\longleftarrow\\n\in\N}}\Z/p^n\Z\to\cdots\to\Z/p^2\Z\to\Z/p\Z.
\]

We may define the local field $\Q_p$ as $\Frac\Z_p$, or by the completion of $\Q$ with respect to $|\cdot|_p$, where $|\cdot|_p$ is an absolute value on $\Q$ such that $|p^ma|_p=\frac1{p^m}$.
Then,
$\Z_p:=\{x\in\Q_p:|x|_p\le1\}$.

\begin{ex}
Let $p=5$.
Observe
\begin{align*}
3^{-1}&\equiv2_5\pmod5\\
&\equiv32_5\pmod{5^2}\\
&\equiv132_5\pmod{5^3}\\
&\quad\vdots\\
&\equiv1313132_5\pmod{5^7}.
\end{align*}
Therefore, we can write
\[3^{-1}=\overline{13}2_5=2+3p+p^2+3p^3+p^4+\cdots.\]
Since there is no term of negative power of $5$, the number $3^{-1}$ is a $5$-adic integer.
\end{ex}
\begin{ex}
Let $p=3$.
\begin{align*}
7&\equiv1_3^2\pmod3\\
&\equiv111_3^2\pmod{3^3}\\
&\equiv20111_3^2\pmod{3^5}\\
&\equiv120020111_3^2\pmod{3^9}\cdots.
\end{align*}
Therefore, we can write
\[\sqrt7=\cdots120020111_3=1+p+p^2+2p^4+2p^7+p^8+\cdots.\]
Since there is no term of negative power of $2$, $\sqrt7$ is a $3$-adic integer.
\end{ex}

\begin{prb}
\begin{parts}
\item
The absolute value $|\cdot|_p$ is nonarchimedean: it satisfies $|x+y|_p\le\max\{|x|_p,|y|_p\}$.
\item
Every triangle in $\Q_p$ is isosceles.
\item
$\Z_p$ is a discrete valuation ring: it is local PID.
\item
$\Z_p$ is open and compact.
Hence $\Q_p$ is locally compact Hausdorff.
\end{parts}
\end{prb}
\begin{pf}
$\Z_p$ is open clearly.
Let us show limit point compactness.
Let $A\subset\Z_p$ be infinite.
Since $\Z_p$ is a finite union of cosets $p\Z_p$, there is $\alpha_0$ such that $A\cap(\alpha_0+p\Z_p)$ is infinite.
Inductively, since
\[\alpha_n+p^{n+1}\Z_p=\bigcup_{1\le x<p}(\alpha_n+xp^{n+1}+p^{n+2}\Z_p),\]
we can choose $\alpha_{n+1}$ such that $\alpha_n\equiv\alpha_{n+1}\pmod{p^{n+1}}$ and $A\cap(\alpha_{n+1}+p^{n+2}\Z_p)$ is infinite.
The sequence $\{\alpha_n\}$ is Cauchy, and the limit is clearly in $\Z_p$.
\end{pf}


\section{Hasse-Minkowski theorem}

\begin{thm}[Sum of two squares]
A positive integer $m$ can be written as a sum of two squares if and only if $v_p(m)$ is even for all primes $p\equiv3\pmod4$.

Let $p$ be a prime with $p\equiv1\pmod4$.
Every $p$-adic integer is a sum of two squares of $p$-adic integers.
\end{thm}





\chapter{Elliptic curves}
\section{Elliptic curves over $\C$}

$\P^2(\C)$
\begin{prb}[Weierstrass form]
Let $K$ be a field.
An \emph{elliptic curve} over $K$ is a smooth algebraic curve $E$ of genus one together with a specified base point $O$.
There is an embedding $w:E\to\P^2$ such that $O$ is mapped to the infinity $(0:1:0)$ on the $y$-axis and $w(E)$ is the zero set of $y^2z-x^3+27c_4xz^2+54c_6z^3$.
\end{prb}

\begin{prb}[Legendre form]
$E(\C)\to\P^1(\C)$ is a double cover ramified over the four points $0,1,\lambda,\infty\in\P^1(\C)$.
\end{prb}

\begin{prb}[Invariants of elliptic curves]
discriminant, $j$-invariant.
\end{prb}


\begin{prb}[Group law]
from tangent lines, from Picard group, from quotient of the complex plane,
\end{prb}

\begin{prb}[Isogenies]
If a morphism $E_1\to E_2$ maps $O_1$ to $O_2$, then it is a group isomorphism.
dual isogeny,
\end{prb}

\begin{prb}[Tate modules]
Let $K$ be a field of characteristic $p$ and $E$ be an elliptic curve over $K$.
The set $E[m]$ of points of order $m$ is isomorphic to $(\Z/m\Z)^2$, where $m$ is prime to the characteristic of $K$.
For a prime $\ell\in\Z$ such that $p\ne0$, the \emph{$\ell$-adic Tate module} is the group $T_\ell(E):=\lim_{\leftarrow n}E[\ell^n]$.
As a $\Z_\ell$-module, we have $T_\ell(E)\cong\Z_\ell^2$ and $T_p(E)\cong0$ or $\Z_p$ if $p>0$.
Then, we can associated a representation $G_{\bar K/K}\to\GL_2(\Z_\ell)$ and $G_{\bar K/K}\to\GL_2(\Q_\ell)$ by tensoring with $\Q_\ell$.

Let $\mu_{\ell^n}$ be the group of $\ell^n$-th roots of unity in $\bar K^\times$.
Then, we can also define a Tate module $T_\ell(\mu)$ as the projective limit, and it is a multiplicative subgroup of $\bar K^\times$ such that $T_\ell(\mu)\cong\Z_\ell$.
Thus the one-dimensional Galois representation $G_{\bar K/K}\to\Aut(\Z_\ell)=\Z_\ell^\times$, called the \emph{cyclotomic representation}.

The group of torsion points are homology groups which admit Galois actions.
($E[m]$ and $T_\ell(E)$ can be identified with $H_1(E,\Z/m\Z)$ and $H_1(E,\Z_\ell)$.)
\end{prb}

\begin{prb}[Weil pairing]
\end{prb}
\begin{prb}[Endomorphism rings]
central simple algebras over $K$ is classified by the Brauer group $\mathrm{Br}(K)=H^2(G_{\bar K/K},\bar K^\times)$.
\end{prb}
\begin{prb}[Automorphism groups]
The order of $\Aut(E)$ divides $24$.
$\Aut(E)$ is isomorphic to $\Z/2\Z$, $\Z/4\Z$, or $\Z/6\Z$ over $\bar K$ of characteristic not $2$ or $3$.
\end{prb}

\textbf{Step 1.}
The Riemann-Roch theorem proves that every curve of genus 1 with a specified base point can be described by the first kind of Weierstrass equation.
Explicitly, the first form of Weierstrass equation is
\[y^2+a_1xy+a_3y=x^3+a_2x^2+a_4x+a_6.\]
\[b_2:=a_1^2+4a_2,\quad b_4=a_1a_3+2a_4,\quad b_6=a_3^2+4a_6.\]
\[y\mapsto y-\frac12(a_1x+a_3).\]
\[y^2=x^3+\frac14b_2x^2+\frac12b_4x+\frac14b_6.\]
\[c_4:=b_2^2-24b_4,\quad c_6:=-b_2^3+36b_2b_4-216b_6.\]
\[x\mapsto x-\frac1{12}b_2.\]
\[y^2=x^3-\frac1{48}c_4x-\frac1{864}c_6.\]
\[b_8:=a_1^2a_6-a_1a_3a_4+4a_2a_6+a_2a_3^2-a_4^2=\frac{b_2b_6-b_4^2}4.\]
\[\Delta:=-b_2^2b_8-8b_4^3-27b_6^2+9b_2b_4b_6=\frac{c_4^3-c_6^2}{1728},\quad j:=c_4^3/\Delta.\]


\begin{thm}
Let
\[E:y^2=x^3-Ax-B.\]
TFAE:
\begin{parts}
\item A point $(x,y)$ is a singular point of $E$.
\item $y=0$ and $x$ is a double root of $x^3-Ax-B$.
\item $\Delta=0$.
\end{parts}
\end{thm}
\begin{pf}
(1)$\Rightarrow$(2)
$\pd_yf=0$ implies $y=0$. $f=\pd_xf=0$ implies $x$ is a double root of $x^3-Ax-B$.
$A$ determines whether $x$ is either cusp of node.
\end{pf}





$\C/\Lambda$

\begin{prb}[Invariant differential]
The invariant differential $\omega$ is a one-form that is invariant under the translation, which is unique up to scalar.
If we consider a projective embedding $E\to\P^2$ such that $E(\C)$ is given by the equation $y^2=f(x)$ for a cubic $f\in\C[x]$, then we can set $\omega=dx/y$.
This implies that the second coordinate is equal to the first coordinate, the Weierstrass $\wp$-function, in the embedding. (Since $\phi:\C/\Lambda\to E(\C)$ is a group homomorphism and $dz$ is the invariant differential on $\C/\Lambda$, we have $dz=\phi^*(dx/y)$, so $(\wp(x):\wp'(z):1)$.)
\end{prb}










\section{Elliptic curves over $\Q$}
Finitely generatedness:Mordell-Weil, Mazur torsion
Integral solutions:Nagell-Lutz, Siegel, Baker's bound
\section{Elliptic curves over $\F_p$}

\end{document}
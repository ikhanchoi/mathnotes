\documentclass{../exp}
\usepackage{../../ikany}

\title{Morse Theory}

\begin{document}
\maketitle

\section{Morse functions}

\begin{defn}
Let $M$ be a manifold.
A \emph{Morse function} is a smooth function $f:M\to\R$ such that all critical points are nondegenerate.
\end{defn}

\begin{prop}
Let $M$ be an embedded submanifold of $\R^n$.
For almost every point $p\in\R^n$, the function $f:M\to\R:x\mapsto\|x-p\|^2$ is Morse.
\end{prop}
\begin{pf}
Suppose that $p\in\R^n$ makes $f$ be not Morse so that it possesses a degenerate critical point.
Note that the notation $x$ can denote not only a point variable on $M$ but also the embedding map $M\emb\R^n$.
Let $N\subset M\times\R^n$ be the normal bundle of the tangent bundle $TM$ and define a map $\f:N\to\R^n$ such that $\f(x,y)=x+y$.
We claim that the point $(x,p-x)$ is contained in $N$ and $\f$ is critical at this point if $f$ is degenerate at $x$.

The differential of $f$ is
\[df_x(v)=2(x-p)\cdot dx(v)=2(x-p)\cdot v,\]
so $x$ is critical point if and only if $x-p$ is proportional to $T_xM$.

Let $\{x^i\}_{i=1}^m$ be orthonormal coordinates for $M$ and let $\{e_j\}_{j=1}^{n-m}$ be an orthonormal frame field of $N$.
Define coordinate functions $\{x^i,y^j\}$ on the manifold $N$ by
\[x^i(x,y):=x^i(x),\quad\text{and}\quad y^j(x,y):=y\cdot e_j(x).\]
Then,
\[\left\{\,\pd{x}{x^1},\cdots,\pd{x}{x^m},\pd{y}{y^1},\cdots,\pd{y}{y^{n-m}}\,\right\}\]
always form an orthonormal basis on $\R^n$ and

Since
\[\pd{\f}{x^i}=\pd{x}{x^i}+\pd{y}{x^i}\quad\text{and}\quad\pd{\f}{y^j}=\pd{y}{y^j},\]
we have
\begin{alignat*}{2}
\pd{\f}{x^i}\cdot\pd{x}{x^k}&=\delta_{ik}-y\cdot\pd{x}{x^i}{x^k},\qquad&
\pd{\f}{x^i}\cdot\pd{y}{y^l}&=-y\cdot\pd{y}{x^i}{y^l},\\
\pd{\f}{y^j}\cdot\pd{x}{x^k}&=0,&
\pd{\f}{y^j}\cdot\pd{y}{y^l}&=\delta_{jl}.
\end{alignat*}
To represent $d\f(\pd_{x^1},\cdots,\pd_{y^{n-m}})$ with matrix, we can write
\[\begin{pmatrix}\displaystyle\pd{\f}{x^i}\\\displaystyle\pd{\f}{y^j}\end{pmatrix}
\begin{pmatrix}\displaystyle\pd{x}{x^k}&\displaystyle\pd{y}{y^l}\end{pmatrix}
=\begin{pmatrix}\displaystyle\Id-y\cdot\pd{x}{x^i}{x^k}&\displaystyle-y\cdot\pd{y}{x^i}{y^l}\\0&\Id\end{pmatrix}.\]
Then,
\[\pd{f}{x^i}{x^j}=2\left(\Id+(x-p)\cdot\pd{x}{x^i}{x^j}\right)\]
deduces that $d\f$ is not surjective at $(x,p-x)$.
Therefore, by the Sard theorem, set of such $p$ has measure zero.
\end{pf}

\begin{prop}
Let $M$ be a manifold.
The set of Morse functions is dense in $C^\infty(M)$.
\end{prop}
\begin{pf}
Let $f$ be a smooth function on $M$.
Embed $M$ in $\R^{d-1}$ such that $x\mapsto(x_2,\cdots,x_d)$.
Then, $x\mapsto(f(x),x_2,\cdots,x_d)$ gives an embedding into $R^d$.
Define a sequence $\{\e_n\}_n\subset\R^n$ such that $\e_n\to0$ and the sequence of functions
\[f_n(x):=\frac{\|x+ne_1+\e_n\|^2-n^2}{2n}\]
is Morse, where $\{e_i\}$ denotes the standard basis of $\R^d$.
This can be done by the previous proposition.
Then,
\begin{align*}
f_n(x)&=\frac{(f(x)+n+\e_n\cdot e_1)^2+\cdots+(x_n+\e_n\cdot e_d)^2-n^2}{2n}\\
&=f(x)+\frac{\|x+\e_n\|}{2n}+\e_n\cdot e_1
\end{align*}
proves that $\|f_n-f\|_{C^k(K)}\to0$ on every compact $K\subset M$.
\end{pf}

\begin{thm}[Morse lemma]
Let $p$ be a nondegenerate critical point of a Morse function $f$ on a manifold $M$.
Then, there exists a local chart $(U,\f)$ of $p$ such that
\[f\circ\f^{-1}(x_1,\cdots,x_m)=f(p)-\sum_{i=1}^kx_i^2+\sum_{i=k+1}^nx_i^2\]
for some $k$.
This chart is called \emph{Morse chart}.
\end{thm}
\begin{pf}
%%%
\end{pf}
\begin{cor}
The critical points of a Morse function are isolated.
In particular, on a compact manifold are finitely many critical points of a Morse function.
\end{cor}

\section{Pseudo-gradients}
\begin{defn}
Let $f$ be a Morse function on a manifold $M$.
A \emph{pseudo-gradient} adapted to $f$ is a vector field $X$ such that
\begin{cond}
\item $df(X)<0$ at all noncritical points,
\item there is a Morse chart at critical points in which $X=\grad f$, where the metric is induced from the chart.
\end{cond}
\end{defn}
\begin{prop}
A pseudo-gradient always exists for any Morse functions.
\end{prop}
\begin{pf}
Cover the manifold with charts such that every critical point is contained in a unique chart, which is Morse.
For each chart $(U,\f)$, we can define a vector field on $U$ by
\[X:=-d\f^{-1}(\grad(f\circ\f^{-1})),\]
using the standard metric on $\f(U)$.
Then, we have
\[df(X)=-\<\grad(f\circ\f^{-1}),\grad(f\circ\f^{-1})\>\le0,\]
where the equality holds only at critical points.
With a partition of unity, the vector fields are combined and easily checked to be pseudogradient.
\end{pf}

\begin{defn}
Let $p$ be a critical point of a Morse function $f$ on a manifold $M$.
Denote $\f^s:M\to M$ by the flow of a pseudo-gradient.
A \emph{stable manifold} is defined as
\[W^s(p):=\{\,x\in M:\lim_{s\to\infty}\f^s(x)=p\,\},\]
and an \emph{unstable manifold} is defined as
\[W^u(p):=\{\,x\in M:\lim_{s\to-\infty}\f^s(x)=p\,\}.\]
\end{defn}
\begin{prop}
The stable manifolds and unstable manifolds are manifolds.
Further, they are diffeomorphic open disks.
Moreover, the index of $p$ is equal to
\[\dim W^u(p)=\codim W^s(p)\].
\end{prop}


\end{document}